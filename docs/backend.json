{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the EduBot Central application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The role of the user (Student, Class Representative, Senior)."
        }
      },
      "required": [
        "id",
        "email",
        "role"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Uses path-based ownership; only the authenticated user can access their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user, matching the Firebase Auth UID."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure prioritizes security and scalability by adhering to the principles of Authorization Independence and Structural Segregation. Since the application involves user roles (Student, Class Representative, Senior), and user data, we will use path-based ownership for private user data and dedicated collections for global roles.\n\n1.  **Authorization Independence:** The structure avoids `get()` calls in security rules by relying on path-based authorization (`/users/{userId}`).\n2.  **Structural Segregation:** User data is stored under `/users/{userId}`, ensuring all documents in this subcollection share the same ownership-based security requirements.\n3.  **Access Modeling:** Path-based ownership is employed (`/users/{userId}`) for user profiles and related data. Global roles are managed implicitly through path-based existence checks in security rules.\n4. **QAPs (Rules are not Filters):** Since we're primarily dealing with user-owned data and roles are simple, the structure naturally supports secure `list` operations. Listing documents under `/users/{userId}` is implicitly restricted to the authenticated user.\n\nThis structure promotes clear, maintainable security rules focused on `request.auth.uid` and avoids complex hierarchical dependencies."
  }
}